"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var rowHeight=24,_default={cell:{autofocus:".vxe-textarea",renderEdit:function(e,t,o,l){var r=l.$excel.excelStore.uploadRows,s=o.row,a=o.column;return[e("div",{class:"vxe-input--wrapper vxe-excel-cell",style:{height:"".concat(a.renderHeight-1,"px")}},[e("textarea",{class:"vxe-textarea",style:{width:"".concat(a.renderWidth,"px")},domProps:{value:_tools.UtilTools.getCellValue(s,a)},on:{input:function(e){var t=e.target;_tools.UtilTools.setCellValue(s,a,t.value),t.scrollHeight>t.offsetHeight&&(-1===r.indexOf(s)?t.style.width="".concat(t.offsetWidth+20,"px"):t.style.height="".concat(t.scrollHeight,"px"))},change:function(e){_tools.UtilTools.setCellValue(s,a,e.target.value),-1===r.indexOf(s)&&r.push(s)},keydown:function(e){var t=e.target;if(e.altKey&&13===e.keyCode){e.preventDefault(),e.stopPropagation();var o=_tools.DomTools.getCursorPosition(t),l=o.end,r=t.value;r="".concat(r.slice(0,l),"\n").concat(r.slice(l,r.length)),t.value=r,_tools.UtilTools.setCellValue(s,a,r),t.style.height="".concat((Math.floor(t.offsetHeight/rowHeight)+1)*rowHeight,"px"),setTimeout(function(){o.start=o.end=++l,_tools.DomTools.setCursorPosition(t,o)})}}}})])]},renderCell:function(e,t,o){var l=o.row,r=o.column;return[e("span",{domProps:{innerHTML:_xeUtils.default.escape(_tools.UtilTools.getCellValue(l,r)).replace(/\n/g,"<br>")}})]}}};exports.default=_default;